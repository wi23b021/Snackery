<!-- 
    Snackery ‚Äì Produkte verwalten (admin_products.html)
    Diese Seite erlaubt Admins, Produkte zu verwalten (anzeigen, bearbeiten, l√∂schen).
    Technologien: HTML5, CSS, JavaScript (AJAX)
-->

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Produkte verwalten ‚Äì Snackery</title>

    <!-- Einbinden des globalen Stylesheets -->
    <link rel="stylesheet" href="../res/css/style.css">
</head>

<body>

    <!-- ==================== HEADER ==================== -->
    <header>
        <div class="logo">
            <a href="/Snackery/index.html">
                <img src="../res/img/snackery-logo.jpg" alt="Snackery Logo">
            </a>
        </div>

        <!-- Navigation -->
        <nav>
            <ul>
                <li><a href="/Snackery/index.html">Startseite</a></li>
                <li><a href="admin.html">Adminbereich</a></li>
                <li><a href="login.html">Logout</a></li>
            </ul>
        </nav>
    </header>

    <!-- ==================== PRODUKTLISTE ==================== -->
    <main class="profile-container">
        <h2>Produkte verwalten</h2>

        <!-- Button zum Hinzuf√ºgen eines neuen Produkts -->
        <a href="add_product.html" class="btn">+ Neues Produkt hinzuf√ºgen</a>

        <!-- Bereich f√ºr die Produktliste -->
        <div id="productTableContainer" style="margin-top: 30px;">
            <p>üîÑ Produkte werden geladen...</p>
        </div>
    </main>

    <!-- ==================== FOOTER ==================== -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Snackery</p>
            <div class="footer-links">
                <a href="impressum.html">Impressum</a>
                <a href="hilfe.html">Hilfe</a>
            </div>
        </div>
    </footer>

    <!-- ==================== JAVASCRIPT: PRODUKTE LADEN ==================== -->
    <script>
        // Produkte vom Server laden
        fetch("../../Backend/logic/requestHandler.php?action=getProducts")
            .then(response => response.json())
            .then(products => {
                const container = document.getElementById("productTableContainer");

                if (products.length === 0) {
                    container.innerHTML = "<p>‚ùå Keine Produkte gefunden.</p>";
                    return;
                }

                // Tabelle erstellen
                let tableHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background-color: #f5f5f5;">
                                <th>ID</th>
                                <th>Name</th>
                                <th>Preis</th>
                                <th>Kategorie</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody>`;

                products.forEach(product => {
                    tableHTML += `
                        <tr>
                            <td>${product.id}</td>
                            <td>${product.name}</td>
                            <td>${parseFloat(product.price).toFixed(2).replace(".", ",")} ‚Ç¨</td>
                            <td>${product.category}</td>
                            <td>
                                <a class="btn" href="edit_product.html?id=${product.id}">Bearbeiten</a>
                                <button class="btn deleteBtn" data-id="${product.id}">L√∂schen</button>
                            </td>
                        </tr>`;
                });

                tableHTML += "</tbody></table>";
                container.innerHTML = tableHTML;

                // L√∂schen-Buttons aktivieren
                document.querySelectorAll(".deleteBtn").forEach(button => {
                    button.addEventListener("click", () => {
                        const productId = button.dataset.id;
                        const confirmDelete = confirm("Willst du dieses Produkt wirklich l√∂schen?");
                        if (confirmDelete) {
                            alert(`üóëÔ∏è Produkt mit ID ${productId} l√∂schen (per Backend-Request).`);
                            // Hier k√∂nnte sp√§ter ein fetch() zum L√∂schen eingebaut werden
                        }
                    });
                });
            })
            .catch(error => {
                document.getElementById("productTableContainer").innerHTML = "<p>‚ùå Fehler beim Laden der Produkte.</p>";
                console.error(error);
            });
    </script>

</body>

</html>