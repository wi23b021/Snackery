<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Produkt löschen – Snackery</title>
    <link rel="stylesheet" href="../res/css/style.css">
</head>

<body>

    <!-- ========== HEADER ========== -->
    <header>
        <div class="logo">
            <a href="/Snackery/index.html">
                <img src="../res/img/snackery-logo.jpg" alt="Snackery Logo">
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="/Snackery/index.html">Startseite</a></li>
                <li><a href="admin_products.html">Zurück zur Produktübersicht</a></li>
            </ul>
        </nav>
    </header>

    <!-- ========== HAUPTBEREICH ========== -->
    <main>
        <div class="register-container">
            <h2>Produkt wird gelöscht...</h2>
            <p>Bitte einen Moment Geduld.</p>
        </div>
    </main>

    <!-- ========== JAVASCRIPT ========== -->
    <script>
        // ID aus der URL auslesen
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');

        // Wenn keine ID übergeben wurde, zur Adminseite zurück
        if (!productId) {
            window.location.href = "admin_products.html";
        }

        // AJAX-Request an das Backend zum Löschen des Produkts
        fetch(`../../Backend/logic/requestHandler.php?action=deleteProduct&id=${productId}`, {
                method: "DELETE"
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert("✅ Produkt erfolgreich gelöscht!");
                } else {
                    alert("❌ Fehler beim Löschen des Produkts.");
                }
                // Zurück zur Produktübersicht
                window.location.href = "admin_products.html";
            })
            .catch(error => {
                alert("❌ Serverfehler beim Löschen.");
                console.error(error);
                window.location.href = "admin_products.html";
            });
    </script>

</body>

</html>