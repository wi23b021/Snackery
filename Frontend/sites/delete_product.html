<!-- 
    Snackery – Produkt löschen (delete_product.html)
    Diese Seite löscht ein Produkt basierend auf der ID in der URL.
    Technologien: HTML5, CSS, JavaScript (AJAX)
-->

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Produkt löschen – Snackery</title>

    <!-- Verknüpfung mit globalem Stylesheet -->
    <link rel="stylesheet" href="../res/css/style.css">
</head>

<body>

    <!-- ==================== HEADER ==================== -->
    <header>
        <div class="logo">
            <a href="/Snackery/index.html">
                <img src="../res/img/snackery-logo.jpg" alt="Snackery Logo">
            </a>
        </div>

        <!-- Navigation -->
        <nav>
            <ul>
                <li><a href="/Snackery/index.html">Startseite</a></li>
                <li><a href="admin_products.html">Zurück zur Produktübersicht</a></li>
            </ul>
        </nav>
    </header>

    <!-- ==================== LÖSCHBESTÄTIGUNG ==================== -->
    <main>
        <div class="register-container">
            <h2>Produkt wird gelöscht...</h2>
            <p>Bitte einen Moment Geduld.</p>
        </div>
    </main>

    <!-- ==================== JAVASCRIPT: PRODUKT LÖSCHEN ==================== -->
    <script>
        // Produkt-ID aus der URL lesen
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');

        if (!productId) {
            // Falls keine ID vorhanden ist, zurück zur Produktübersicht
            window.location.href = "admin_products.html";
        }

        // Produkt löschen via Fetch
        fetch(`../../Backend/logic/requestHandler.php?action=deleteProduct&id=${productId}`, {
                method: "DELETE"
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert("✅ Produkt erfolgreich gelöscht!");
                } else {
                    alert("❌ Fehler beim Löschen des Produkts.");
                }
                // Zurück zur Produktliste
                window.location.href = "admin_products.html";
            })
            .catch(error => {
                alert("❌ Serverfehler beim Löschen.");
                console.error(error);
                window.location.href = "admin_products.html";
            });
    </script>

</body>

</html>